<div class="wrapper wrapper-content full-height" ng-controller="MailboxCtrl">
  <!-- Mailbox header -->
  <div class="mailbox-header clearfix">
    <h2 class="col-md-4">
      <i class="fa fa-inbox" aria-hidden="true"></i>
      {{ 'Inbox' | translate }}
    </h2>
    <!-- Search -->
    <div class="mailbox-search input-group col-md-8 m-b-sm">
      <input type="text" placeholder="Search email by user, text or ticket" class="input form-control"
      ng-model="searchTerm" ng-change="searchEmails()" aria-invalid="false" />
      <span class="input-group-btn">
        <button type="button" class="btn btn btn-default"><i class="fa fa-close"></i></button>
        <button class="btn btn-primary" accept="*/*" ngf-max-size="55MB">{{ 'New Email' | translate}}</button>
      </span>
    </div>
  </div>
  <!-- Mailbox content -->
  <div class="mailbox-content full-height clearfix">
    <!-- Conversations -->
    <ul class="mailbox-convers col-md-6 col-lg-4 list-unstyled">
      <!-- Mail -->
      <li class="mail media clearfix" ng-repeat="conv in inbox" ng-init="mail = conv.mails[conv.mails.length - 1]"
          ng-class="{'active': conv.active}">
        <!-- Mail header -->
        <div class="mail-avatar media-left">
          <a href="">
            <img alt="image" src="img/a2.jpg">
          </a>
        </div>
        <!-- Mail content -->
        <div class="mail-content media-body">
          <!-- Sender mail and send date -->
          <p class="clearfix">
            <a class="mail-sender dsp-inline-block" href="#">{{ ::mail.sender }}</a>
            <small class="mail-date dsp-inline-block text-muted">
              {{ ::mail.received | date:'medium' }}
            </small>
          </p>
          <!-- Mail body preview -->
          <a href="" class="mail-body-preview" ng-click="selectConv(conv)"
             role="button">
            <h4 class="mail-subject">{{ ::mail.subject }}</h4>
            {{ ::mail.preview | cutLongText:150:'...' }}
          </a>
          <div class="clearfix">
            <div class="pull-left">
              <button class="btn btn-white btn-xs"><a href>Ticket One</a></button>
              <button class="btn btn-white btn-xs"><a href>Important</a></button>
            </div>
            <div class="pull-right dropdown">
              <button class="btn-white">
                <i class="fa fa-eye"></i>
              </button>
              <button class="btn-white">
                <i class="fa fa-star-o"></i>
              </button>
              <button data-toggle="dropdown" class="dropdown-toggle btn-white">
                <i class="fa fa-angle-down"></i>
              </button>
              <ul class="dropdown-menu m-t-xs">
                <li><a href="#">Config</a></li>
              </ul>
            </div>
          </div>
        </div>
      </li>
    </ul>
    <!-- Conversation view -->
    <ul class="mailbox-conv-view col-md-6 col-lg-8 list-unstyled">
      <!-- Conversation subject -->
      <li class="mailbox-conv-subject" ng-if="activeConv != null"><h2>{{ activeConv.mails[0].subject }}</h2></li>
      <!-- Placeholder -->
      <li class="mailbox-pholder text-muted" ng-if="activeConv == null">
        <h2>{{ 'Select a conversation to view' | translate }}</h2>
      </li>
      <!-- Mail reply form -->
      <li class="mail-reply" uib-collapse="!mailReplyForm">
        <div class="mail-avatar mail-reply-avatar">
          <a href=""><img alt="image" src="img/a2.jpg"></a>
        </div>
        <!-- Reply editor -->
        <div class="mail-reply-body">
          <div class="mail-reply-to">
            <strong>To:</strong>
            <ul class="list-unstyled list-inline dsp-inline-block">
              <li><a href="">Stein@multimedianordic.no</a></li>
            </ul>
          </div>
          <textarea id="" class="form-control" name="" rows="10"></textarea>
        </div>
      </li>
      <!-- Mail -->
      <li class="mail conv-view media clearfix" ng-repeat="mail in activeConv.mails | orderBy:received:true"
          data-mail-id="{{ ::mail.id }}">
        <!-- Mail header -->
        <div class="mail-avatar media-left">
          <a href=""><img alt="image" src="img/a2.jpg"></a>
        </div>
        <!-- Mail content -->
        <div class="mail-content media-body">
          <!-- Sender, mail controls-->
          <div class="clearfix">
            <a class="mail-sender conv-view dsp-inline-block" href="#">{{ ::mail.sender }}</a>
            <span class="mail-ctrls conv-view pull-right">
              <button class="btn-white" ng-click="toggleReplyForm(mail)">
                <i class="fa fa-reply"></i>
                {{ 'Reply' | translate }}
              </button>
              <!-- <button class="btn-white" ng-click="toggleReplyForm(mail)"> -->
              <!--   <i class="fa fa-reply-all"></i> -->
              <!--   {{ 'Reply all' | translate }} -->
              <!-- </button> -->
              <button class="btn-white" ng-click="mail.active = !mail.active">
                <i class="fa" ng-class="mail.active ? 'fa-angle-up' : 'fa-angle-down'"></i>
              </button>
            </span>
          </div>
          <!-- Receivers -->
          <div class="clearfix">
            <span class="text-muted">To:</span>
            <ul class="list-unstyled list-inline dsp-inline-block">
              <li><a href="">{{ ::mail.receivedBy }}</a></li>
            </ul>
            <span class="mail-date pull-right text-muted">{{ ::mail.received | date:'medium' }}</small>
          </div>
          <!-- Mail tags -->
          <div class="mail-tags conv-view">
            <button class="btn btn-white btn-xs"><a href>Ticket One</a></button>
            <button class="btn btn-white btn-xs"><a href>Important</a></button>
          </div>
          <!-- Mail body -->
          <div class="mail-body" uib-collapse="!mail.active">
            <!-- Mail body content -->
            <div ng-bind-html="mail.body"></div>
          </div>
          <!-- Mail body preview -->
          <a href="" class="mail-body-preview conv-view" ng-hide="mail.active" ng-click="mail.active = true"
             role="button">
            {{ ::mail.preview | cutLongText:150:'...' }}
          </a>
        </div>
      </li>
    </ul>
  </div>
</div>
