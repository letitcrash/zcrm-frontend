<!-- Form box -->
<form name="form" class="ibox ticket-form col-xs-12 col-lg-8 p-l-none">
  <!-- Form title -->
  <div class="ibox-title clearfix">
    <a ui-sref="index.tickets.list()" class="btn btn-default pull-left" ><i class="fa fa-chevron-left"></i></a>
    <h3 class="ibox-title-text pull-left">{{ 'Create ticket' | translate }}</h3>
  </div>
  <!-- Form body -->
  <div class="ibox-content clearfix">
    <!-- Ticket title -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Ticket name' | translate }}:</label>
      <div class="col-xs-9">
        <input class="form-control" type="text" name="subject" required placeholder="Enter name here"
               ng-model="tsCreate.model.subject">
      </div>
    </div>
    <!-- Ticket description -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Description' | translate }}:</label>
      <div class="col-xs-9">
        <div data-summernote data-height="200" name="description" ng-model="tsCreate.model.description"></div>
      </div>
    </div>
    <!-- Ticket priority and status -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Priority' | translate }}:</label>
      <div class="col-xs-4" data-crm-ticket-priority-dropdown data-ng-model="tsCreate.model.priority"></div>
      <label class="ticket-form-label control-label col-xs-2">{{ 'Status' | translate }}:</label>
      <div class="col-xs-3" data-crm-ticket-status-dropdown data-ng-model="tsCreate.model.status"></div>
    </div>
    <!-- Ticket agents -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Agent(s)' | translate }}:</label>
      <div class="col-xs-7" crm-select-employees="tsCreate.model.agents" placeholder="Enter name or username here">
      </div>
      <div class="col-xs-2">
        <button class="btn btn-default btn-block" type="button" ng-bind="'Assign to me' | translate"
                ng-click="tsCreate.assignToMe()"></button>
      </div>
    </div>
    <!-- Ticket teams -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Team(s)' | translate }}:</label>
      <div class="col-xs-9">
        <div data-ui-select name="teams" data-ng-model="tsCreate.model.teams" multiple data-crm-select-multiple>
          <div data-ui-select-choices
               data-repeat="team in tsCreate.teams | filter: $select.search track by team.id"
               data-refresh="tsCreate.getTeams($select.search)" data-refresh-delay="500"
               data-minimum-input-length="1">
               <h4 class="dsp-inline-block" data-ng-bind-html="::team.name | highlight: $select.search"></h4>
               <span class="dsp-inline-block" data-ng-if="team.description.length > 0">
                 ({{ ::team.description }})
               </span>
          </div>
          <div data-ui-select-match placeholder="Enter name of the team here">{{ $item.name }}</div>
        </div>
      </div>
    </div>
    <!-- Ticket project -->
    <div class="form-group ticket-form-group clearfix">
      <label class="ticket-form-label control-label col-xs-3">{{ 'Project' | translate }}:</label>
      <div class="col-xs-9">
        <input type="text" data-ng-model="tsCreate.model.project" name="project" hidden required>
        <div data-ui-select name="project" data-ng-model="tsCreate.model.project">
          <div data-ui-select-match placeholder="Select a project">{{ $select.selected.name }}</div>
          <div data-ui-select-choices
               data-repeat="proj in tsCreate.projects | filter: $select.search track by proj.name"
               data-refresh="tsCreate.getProjects($select.search)" data-refresh-delay="500"
               data-minimum-input-length="1">
            <h4 data-ng-bind-html="::proj.name | highlight: $select.search"></h4>
            <span class="text-muted" data-ng-if="proj.description.length > 0" data-ng-bind="::proj.description"></span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Form footer -->
  <div class="ibox-footer ticket-form-footer clearfix">
    <h4 class="text-center" data-ng-show="tsCreate.loadStats.form === 2">
      <i class="fa fa-spinner fa-pulse fa-2x fa-fw fa-spin valign-middle"></i>
      <span class="valign-middle">{{ 'Creating' | translate }}...</span>
    </h4>
    <div class="text-center" data-ng-show="tsCreate.loadStats.form === 0">
      <h4>
        <span class="fa fa-ban text-danger"></span>
        {{ 'Something goes wrong. Please try again.' | translate }}
      </h4>
      <button class="btn btn-default btn-sm" type="button" data-ng-click="tsCreate.loadStats.form = 1"
              data-ng-bind="'Try again' | translate "></button>
    </div>
    <div class="col-xs-9 col-xs-offset-3" data-ng-show="tsCreate.loadStats.form === 1">
      <button class="btn btn-primary" type="submit" data-ng-click="tsCreate.createTicket(form)"
              data-ng-disabled="form.$invalid">
        {{ 'Create' | translate }}
      </button>
      <a data-ui-sref="index.tickets.list()" class="btn btn-danger">{{ 'Discard' | translate }}</a>
    </div>
  </div>
</form>
